<p>This is a coin flip simulator. It compare theoretical binomial distribution with experimental results</p>
<div class="text-error">In order to use the plot directive, you must install the "matplotlib" Python package.</div><p><a class="reference external" href="link://listing/listings/python/coinflip.py">listings/python/coinflip.py</a>  <a class="reference external" href="link://listing_source/listings/python/coinflip.py">(Source)</a></p>
<div class="code"><pre class="code python"><a id="rest_code_4c91d62639714b11877b0c9b11b0d556-1" name="rest_code_4c91d62639714b11877b0c9b11b0d556-1" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-2" name="rest_code_4c91d62639714b11877b0c9b11b0d556-2" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-3" name="rest_code_4c91d62639714b11877b0c9b11b0d556-3" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-4" name="rest_code_4c91d62639714b11877b0c9b11b0d556-4" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-5" name="rest_code_4c91d62639714b11877b0c9b11b0d556-5" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-6" name="rest_code_4c91d62639714b11877b0c9b11b0d556-6" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-6"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-7" name="rest_code_4c91d62639714b11877b0c9b11b0d556-7" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">Nchoosek</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-8" name="rest_code_4c91d62639714b11877b0c9b11b0d556-8" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-8"></a>    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">k</span><span class="p">))</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-9" name="rest_code_4c91d62639714b11877b0c9b11b0d556-9" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-9"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-10" name="rest_code_4c91d62639714b11877b0c9b11b0d556-10" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-10"></a><span class="k">def</span><span class="w"> </span><span class="nf">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-11" name="rest_code_4c91d62639714b11877b0c9b11b0d556-11" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-11"></a>    <span class="k">return</span> <span class="n">Nchoosek</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-12" name="rest_code_4c91d62639714b11877b0c9b11b0d556-12" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-12"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-13" name="rest_code_4c91d62639714b11877b0c9b11b0d556-13" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-13"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-14" name="rest_code_4c91d62639714b11877b0c9b11b0d556-14" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-14"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_experiment</span><span class="p">(</span><span class="n">n_flips</span><span class="p">,</span> <span class="n">n_experiments</span><span class="p">,</span> <span class="n">p_heads</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-15" name="rest_code_4c91d62639714b11877b0c9b11b0d556-15" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-15"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-16" name="rest_code_4c91d62639714b11877b0c9b11b0d556-16" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-16"></a><span class="sd">    Simulate coin flips and count number of heads.</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-17" name="rest_code_4c91d62639714b11877b0c9b11b0d556-17" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-17"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-18" name="rest_code_4c91d62639714b11877b0c9b11b0d556-18" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-18"></a><span class="sd">    :param n_flips: Number of coin flips per experiment.</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-19" name="rest_code_4c91d62639714b11877b0c9b11b0d556-19" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-19"></a><span class="sd">    :param n_experiments: Number of experiments to run.</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-20" name="rest_code_4c91d62639714b11877b0c9b11b0d556-20" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-20"></a><span class="sd">    :param p_heads: Probability of getting heads (default 0.5 for a fair coin)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-21" name="rest_code_4c91d62639714b11877b0c9b11b0d556-21" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-21"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-22" name="rest_code_4c91d62639714b11877b0c9b11b0d556-22" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-22"></a><span class="sd">    :return: List of head counts for each experiment.</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-23" name="rest_code_4c91d62639714b11877b0c9b11b0d556-23" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-23"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-24" name="rest_code_4c91d62639714b11877b0c9b11b0d556-24" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-24"></a>    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-25" name="rest_code_4c91d62639714b11877b0c9b11b0d556-25" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-25"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-26" name="rest_code_4c91d62639714b11877b0c9b11b0d556-26" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-26"></a>    <span class="k">for</span> <span class="n">experiment</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_experiments</span><span class="p">):</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-27" name="rest_code_4c91d62639714b11877b0c9b11b0d556-27" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-27"></a>        <span class="n">flips</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">p_heads</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_flips</span><span class="p">)]</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-28" name="rest_code_4c91d62639714b11877b0c9b11b0d556-28" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-28"></a>        <span class="n">heads_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">flips</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-29" name="rest_code_4c91d62639714b11877b0c9b11b0d556-29" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-29"></a>        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">heads_count</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-30" name="rest_code_4c91d62639714b11877b0c9b11b0d556-30" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-30"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-31" name="rest_code_4c91d62639714b11877b0c9b11b0d556-31" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-31"></a>    <span class="k">return</span> <span class="n">results</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-32" name="rest_code_4c91d62639714b11877b0c9b11b0d556-32" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-32"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-33" name="rest_code_4c91d62639714b11877b0c9b11b0d556-33" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-33"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-34" name="rest_code_4c91d62639714b11877b0c9b11b0d556-34" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-34"></a><span class="k">def</span><span class="w"> </span><span class="nf">compare_theoretical_vs_experimental</span><span class="p">():</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-35" name="rest_code_4c91d62639714b11877b0c9b11b0d556-35" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-35"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare theoretical binomial distribution with experimental results.&quot;&quot;&quot;</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-36" name="rest_code_4c91d62639714b11877b0c9b11b0d556-36" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-36"></a>    <span class="c1"># Parameters</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-37" name="rest_code_4c91d62639714b11877b0c9b11b0d556-37" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-37"></a>    <span class="n">n_flips</span> <span class="o">=</span> <span class="mi">10</span>          <span class="c1"># Number of coin flips per experiment</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-38" name="rest_code_4c91d62639714b11877b0c9b11b0d556-38" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-38"></a>    <span class="n">n_experiments</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Number of experiments to run</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-39" name="rest_code_4c91d62639714b11877b0c9b11b0d556-39" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-39"></a>    <span class="n">p_heads</span> <span class="o">=</span> <span class="mf">0.5</span>         <span class="c1"># Probability of heads (fair coin)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-40" name="rest_code_4c91d62639714b11877b0c9b11b0d556-40" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-40"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-41" name="rest_code_4c91d62639714b11877b0c9b11b0d556-41" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-41"></a>    <span class="c1"># Run the experiment</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-42" name="rest_code_4c91d62639714b11877b0c9b11b0d556-42" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-42"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running </span><span class="si">{</span><span class="n">n_experiments</span><span class="si">}</span><span class="s2"> experiments with </span><span class="si">{</span><span class="n">n_flips</span><span class="si">}</span><span class="s2"> coin flips each...&quot;</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-43" name="rest_code_4c91d62639714b11877b0c9b11b0d556-43" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-43"></a>    <span class="n">results</span> <span class="o">=</span> <span class="n">run_experiment</span><span class="p">(</span><span class="n">n_flips</span><span class="p">,</span> <span class="n">n_experiments</span><span class="p">,</span> <span class="n">p_heads</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-44" name="rest_code_4c91d62639714b11877b0c9b11b0d556-44" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-44"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-45" name="rest_code_4c91d62639714b11877b0c9b11b0d556-45" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-45"></a>    <span class="c1"># Count occurrences of each number of heads</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-46" name="rest_code_4c91d62639714b11877b0c9b11b0d556-46" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-46"></a>    <span class="n">result_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-47" name="rest_code_4c91d62639714b11877b0c9b11b0d556-47" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-47"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-48" name="rest_code_4c91d62639714b11877b0c9b11b0d556-48" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-48"></a>    <span class="c1"># Convert to probabilities</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-49" name="rest_code_4c91d62639714b11877b0c9b11b0d556-49" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-49"></a>    <span class="n">experimental_probs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">/</span><span class="n">n_experiments</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">result_counts</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-50" name="rest_code_4c91d62639714b11877b0c9b11b0d556-50" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-50"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-51" name="rest_code_4c91d62639714b11877b0c9b11b0d556-51" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-51"></a>    <span class="c1"># Calculate theoretical probabilities using your binomial function</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-52" name="rest_code_4c91d62639714b11877b0c9b11b0d556-52" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-52"></a>    <span class="n">theoretical_probs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">binomial</span><span class="p">(</span><span class="n">n_flips</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">p_heads</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_flips</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)}</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-53" name="rest_code_4c91d62639714b11877b0c9b11b0d556-53" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-53"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-54" name="rest_code_4c91d62639714b11877b0c9b11b0d556-54" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-54"></a>    <span class="c1"># Prepare data for plotting</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-55" name="rest_code_4c91d62639714b11877b0c9b11b0d556-55" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-55"></a>    <span class="n">k_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_flips</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-56" name="rest_code_4c91d62639714b11877b0c9b11b0d556-56" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-56"></a>    <span class="n">theoretical_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">theoretical_probs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">k_values</span><span class="p">]</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-57" name="rest_code_4c91d62639714b11877b0c9b11b0d556-57" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-57"></a>    <span class="n">experimental_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">experimental_probs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">k_values</span><span class="p">]</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-58" name="rest_code_4c91d62639714b11877b0c9b11b0d556-58" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-58"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-59" name="rest_code_4c91d62639714b11877b0c9b11b0d556-59" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-59"></a>    <span class="c1"># Plot the results</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-60" name="rest_code_4c91d62639714b11877b0c9b11b0d556-60" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-60"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-61" name="rest_code_4c91d62639714b11877b0c9b11b0d556-61" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-61"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-62" name="rest_code_4c91d62639714b11877b0c9b11b0d556-62" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-62"></a>    <span class="c1"># Bar width and positions</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-63" name="rest_code_4c91d62639714b11877b0c9b11b0d556-63" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-63"></a>    <span class="n">width</span> <span class="o">=</span> <span class="mf">0.35</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-64" name="rest_code_4c91d62639714b11877b0c9b11b0d556-64" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-64"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">k_values</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-65" name="rest_code_4c91d62639714b11877b0c9b11b0d556-65" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-65"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-66" name="rest_code_4c91d62639714b11877b0c9b11b0d556-66" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-66"></a>    <span class="c1"># Create bars</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-67" name="rest_code_4c91d62639714b11877b0c9b11b0d556-67" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-67"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">theoretical_values</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Theoretical Probability&#39;</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-68" name="rest_code_4c91d62639714b11877b0c9b11b0d556-68" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-68"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">experimental_values</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Experimental Probability&#39;</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-69" name="rest_code_4c91d62639714b11877b0c9b11b0d556-69" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-69"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-70" name="rest_code_4c91d62639714b11877b0c9b11b0d556-70" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-70"></a>    <span class="c1"># Add labels and title</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-71" name="rest_code_4c91d62639714b11877b0c9b11b0d556-71" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-71"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Heads&#39;</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-72" name="rest_code_4c91d62639714b11877b0c9b11b0d556-72" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-72"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-73" name="rest_code_4c91d62639714b11877b0c9b11b0d556-73" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-73"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Binomial Distribution: </span><span class="si">{</span><span class="n">n_flips</span><span class="si">}</span><span class="s1"> coin flips, p(heads)=</span><span class="si">{</span><span class="n">p_heads</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-74" name="rest_code_4c91d62639714b11877b0c9b11b0d556-74" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-74"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">k_values</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-75" name="rest_code_4c91d62639714b11877b0c9b11b0d556-75" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-75"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-76" name="rest_code_4c91d62639714b11877b0c9b11b0d556-76" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-76"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-77" name="rest_code_4c91d62639714b11877b0c9b11b0d556-77" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-77"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-78" name="rest_code_4c91d62639714b11877b0c9b11b0d556-78" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-78"></a>    <span class="c1"># Add a text box with statistics</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-79" name="rest_code_4c91d62639714b11877b0c9b11b0d556-79" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-79"></a>    <span class="n">mean_theoretical</span> <span class="o">=</span> <span class="n">n_flips</span> <span class="o">*</span> <span class="n">p_heads</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-80" name="rest_code_4c91d62639714b11877b0c9b11b0d556-80" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-80"></a>    <span class="n">var_theoretical</span> <span class="o">=</span> <span class="n">n_flips</span> <span class="o">*</span> <span class="n">p_heads</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_heads</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-81" name="rest_code_4c91d62639714b11877b0c9b11b0d556-81" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-81"></a>    <span class="n">mean_experimental</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">count</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">result_counts</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="o">/</span> <span class="n">n_experiments</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-82" name="rest_code_4c91d62639714b11877b0c9b11b0d556-82" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-82"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-83" name="rest_code_4c91d62639714b11877b0c9b11b0d556-83" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-83"></a>    <span class="n">stats_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Theoretical Mean: </span><span class="si">{</span><span class="n">mean_theoretical</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-84" name="rest_code_4c91d62639714b11877b0c9b11b0d556-84" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-84"></a>    <span class="n">stats_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Theoretical Variance: </span><span class="si">{</span><span class="n">var_theoretical</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-85" name="rest_code_4c91d62639714b11877b0c9b11b0d556-85" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-85"></a>    <span class="n">stats_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Experimental Mean: </span><span class="si">{</span><span class="n">mean_experimental</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-86" name="rest_code_4c91d62639714b11877b0c9b11b0d556-86" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-86"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-87" name="rest_code_4c91d62639714b11877b0c9b11b0d556-87" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-87"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">stats_text</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-88" name="rest_code_4c91d62639714b11877b0c9b11b0d556-88" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-88"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-89" name="rest_code_4c91d62639714b11877b0c9b11b0d556-89" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-89"></a>    <span class="c1"># Show plot</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-90" name="rest_code_4c91d62639714b11877b0c9b11b0d556-90" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-90"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-91" name="rest_code_4c91d62639714b11877b0c9b11b0d556-91" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-91"></a>    <span class="c1">#plt.show()</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-92" name="rest_code_4c91d62639714b11877b0c9b11b0d556-92" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-92"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;coinflip.png&#39;</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-93" name="rest_code_4c91d62639714b11877b0c9b11b0d556-93" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-93"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-94" name="rest_code_4c91d62639714b11877b0c9b11b0d556-94" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-94"></a>    <span class="c1"># Print summary</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-95" name="rest_code_4c91d62639714b11877b0c9b11b0d556-95" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-95"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Summary:&quot;</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-96" name="rest_code_4c91d62639714b11877b0c9b11b0d556-96" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-96"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Theoretical Mean: </span><span class="si">{</span><span class="n">mean_theoretical</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-97" name="rest_code_4c91d62639714b11877b0c9b11b0d556-97" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-97"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Theoretical Variance: </span><span class="si">{</span><span class="n">var_theoretical</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-98" name="rest_code_4c91d62639714b11877b0c9b11b0d556-98" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-98"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Experimental Mean: </span><span class="si">{</span><span class="n">mean_experimental</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-99" name="rest_code_4c91d62639714b11877b0c9b11b0d556-99" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-99"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-100" name="rest_code_4c91d62639714b11877b0c9b11b0d556-100" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-100"></a>    <span class="c1"># Print probabilities table</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-101" name="rest_code_4c91d62639714b11877b0c9b11b0d556-101" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-101"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Probabilities Table:&quot;</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-102" name="rest_code_4c91d62639714b11877b0c9b11b0d556-102" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-102"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Heads | Theoretical | Experimental | Difference&quot;</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-103" name="rest_code_4c91d62639714b11877b0c9b11b0d556-103" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-103"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-104" name="rest_code_4c91d62639714b11877b0c9b11b0d556-104" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-104"></a>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">k_values</span><span class="p">:</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-105" name="rest_code_4c91d62639714b11877b0c9b11b0d556-105" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-105"></a>        <span class="n">theo</span> <span class="o">=</span> <span class="n">theoretical_probs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-106" name="rest_code_4c91d62639714b11877b0c9b11b0d556-106" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-106"></a>        <span class="n">exp</span> <span class="o">=</span> <span class="n">experimental_probs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-107" name="rest_code_4c91d62639714b11877b0c9b11b0d556-107" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-107"></a>        <span class="n">diff</span> <span class="o">=</span> <span class="n">exp</span> <span class="o">-</span> <span class="n">theo</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-108" name="rest_code_4c91d62639714b11877b0c9b11b0d556-108" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-108"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">5d</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">theo</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">exp</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">diff</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-109" name="rest_code_4c91d62639714b11877b0c9b11b0d556-109" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-109"></a>
<a id="rest_code_4c91d62639714b11877b0c9b11b0d556-110" name="rest_code_4c91d62639714b11877b0c9b11b0d556-110" href="#rest_code_4c91d62639714b11877b0c9b11b0d556-110"></a><span class="n">compare_theoretical_vs_experimental</span><span class="p">()</span>
</pre></div>
